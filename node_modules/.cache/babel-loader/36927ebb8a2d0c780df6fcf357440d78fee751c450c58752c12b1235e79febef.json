{"ast":null,"code":"var _jsxFileName = \"D:\\\\\\u0424\\u0430\\u0439\\u043B\\u044B\\\\\\u0412\\u044F\\u0442\\u0413\\u0423\\\\2 \\u043A\\u0443\\u0440\\u0441\\\\\\u0421\\u0435\\u043C\\u0435\\u0441\\u0442\\u0440 4\\\\Web\\\\\\u043A\\u0443\\u0440\\u0441\\u0430\\u0447\\\\audio-service\\\\audio-service-client\\\\src\\\\components\\\\AudioContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// AudioProvider.js\nimport React, { createContext, useState, useContext, useEffect, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AudioContext = /*#__PURE__*/createContext();\nexport const useAudioContext = () => {\n  _s();\n  return useContext(AudioContext);\n};\n_s(useAudioContext, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const AudioProvider = ({\n  children\n}) => {\n  _s2();\n  const [currentTrack, setCurrentTrack] = useState(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [volume, setVolume] = useState(1);\n  const [audioFiles, setAudioFiles] = useState([]);\n  const [currentTrackIndex, setCurrentTrackIndex] = useState(-1);\n  const audioRef = useRef(null);\n  const updateAudioFiles = async data => {\n    setAudioFiles(data);\n    if (currentTrackIndex !== -1) {\n      const response = await fetch(`http://localhost:8080/audio/${audioFile.id}`);\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      const blob = await response.blob();\n      const audioData = URL.createObjectURL(new Blob([blob]));\n      const currentAudioFile = data[currentTrackIndex];\n      const {\n        id,\n        title,\n        author,\n        image\n      } = currentAudioFile;\n      const imageUrl = image ? `data:image/jpeg;base64,${image.data}` : \"\";\n      const audioUrl = audioData;\n      setCurrentTrack({\n        id,\n        audioUrl,\n        trackName: title,\n        author,\n        imageUrl\n      });\n    }\n  };\n  useEffect(() => {\n    if (currentTrackIndex !== -1) {\n      setCurrentTrack({\n        id: audioFiles[currentTrackIndex].id,\n        audioUrl: udioFiles[currentTrackIndex].audioData,\n        // Оставляем пустым, так как нам нужно заново загрузить аудио при переключении трека\n        trackName: audioFiles[currentTrackIndex].title,\n        author: audioFiles[currentTrackIndex].author,\n        imageUrl: audioFiles[currentTrackIndex].image ? `data:image/jpeg;base64,${audioFiles[currentTrackIndex].image.data}` : \"\"\n      });\n    }\n  }, [audioFiles, currentTrackIndex]);\n  const playNextTrack = () => {\n    if (currentTrackIndex === audioFiles.length - 1) return;\n    const nextIndex = currentTrackIndex + 1;\n    setCurrentTrackIndex(nextIndex);\n  };\n  const playPreviousTrack = () => {\n    if (currentTrackIndex === 0) return;\n    const previousIndex = currentTrackIndex - 1;\n    setCurrentTrackIndex(previousIndex);\n  };\n  return /*#__PURE__*/_jsxDEV(AudioContext.Provider, {\n    value: {\n      currentTrack,\n      setCurrentTrack,\n      isPlaying,\n      setIsPlaying,\n      volume,\n      setVolume,\n      audioFiles,\n      updateAudioFiles,\n      currentTrackIndex,\n      setCurrentTrackIndex,\n      audioRef,\n      playNextTrack,\n      playPreviousTrack\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n};\n_s2(AudioProvider, \"8dMX2JOlSzbHDPB6vdC6BI7VzbM=\");\n_c = AudioProvider;\nAudioProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\nvar _c;\n$RefreshReg$(_c, \"AudioProvider\");","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","useRef","PropTypes","jsxDEV","_jsxDEV","AudioContext","useAudioContext","_s","AudioProvider","children","_s2","currentTrack","setCurrentTrack","isPlaying","setIsPlaying","volume","setVolume","audioFiles","setAudioFiles","currentTrackIndex","setCurrentTrackIndex","audioRef","updateAudioFiles","data","response","fetch","audioFile","id","ok","Error","status","blob","audioData","URL","createObjectURL","Blob","currentAudioFile","title","author","image","imageUrl","audioUrl","trackName","udioFiles","playNextTrack","length","nextIndex","playPreviousTrack","previousIndex","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","propTypes","node","isRequired","$RefreshReg$"],"sources":["D:/Файлы/ВятГУ/2 курс/Семестр 4/Web/курсач/audio-service/audio-service-client/src/components/AudioContext.js"],"sourcesContent":["// AudioProvider.js\r\nimport React, { createContext, useState, useContext, useEffect, useRef } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nconst AudioContext = createContext();\r\n\r\nexport const useAudioContext = () => useContext(AudioContext);\r\n\r\nexport const AudioProvider = ({ children }) => {\r\n  const [currentTrack, setCurrentTrack] = useState(null);\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [volume, setVolume] = useState(1);\r\n  const [audioFiles, setAudioFiles] = useState([]);\r\n  const [currentTrackIndex, setCurrentTrackIndex] = useState(-1);\r\n  const audioRef = useRef(null);\r\n\r\n  const updateAudioFiles = async (data) => {\r\n    setAudioFiles(data);\r\n    if (currentTrackIndex !== -1) {\r\n      const response = await fetch(`http://localhost:8080/audio/${audioFile.id}`);\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n      const blob = await response.blob();\r\n      const audioData = URL.createObjectURL(new Blob([blob]));\r\n\r\n      const currentAudioFile = data[currentTrackIndex];\r\n      const { id, title, author, image } = currentAudioFile;\r\n      const imageUrl = image ? `data:image/jpeg;base64,${image.data}` : \"\";\r\n      const audioUrl = audioData;\r\n  \r\n      setCurrentTrack({\r\n        id,\r\n        audioUrl,\r\n        trackName: title,\r\n        author,\r\n        imageUrl,\r\n      });\r\n    }\r\n  };\r\n  \r\n\r\n  useEffect(() => {\r\n    if (currentTrackIndex !== -1) {\r\n      setCurrentTrack({\r\n        id: audioFiles[currentTrackIndex].id,\r\n        audioUrl: udioFiles[currentTrackIndex].audioData, // Оставляем пустым, так как нам нужно заново загрузить аудио при переключении трека\r\n        trackName: audioFiles[currentTrackIndex].title,\r\n        author: audioFiles[currentTrackIndex].author,\r\n        imageUrl: audioFiles[currentTrackIndex].image ? `data:image/jpeg;base64,${audioFiles[currentTrackIndex].image.data}` : \"\",\r\n      });\r\n    }\r\n  }, [audioFiles, currentTrackIndex]);\r\n\r\n  const playNextTrack = () => {\r\n    if (currentTrackIndex === audioFiles.length - 1) return;\r\n    const nextIndex = currentTrackIndex + 1;\r\n    setCurrentTrackIndex(nextIndex);\r\n  };\r\n\r\n  const playPreviousTrack = () => {\r\n    if (currentTrackIndex === 0) return;\r\n    const previousIndex = currentTrackIndex - 1;\r\n    setCurrentTrackIndex(previousIndex);\r\n  };\r\n\r\n  return (\r\n    <AudioContext.Provider\r\n      value={{\r\n        currentTrack,\r\n        setCurrentTrack,\r\n        isPlaying,\r\n        setIsPlaying,\r\n        volume,\r\n        setVolume,\r\n        audioFiles,\r\n        updateAudioFiles,\r\n        currentTrackIndex,\r\n        setCurrentTrackIndex,\r\n        audioRef,\r\n        playNextTrack,\r\n        playPreviousTrack,\r\n      }}\r\n    >\r\n      {children}\r\n    </AudioContext.Provider>\r\n  );\r\n};\r\n\r\nAudioProvider.propTypes = {\r\n  children: PropTypes.node.isRequired,\r\n};\r\n"],"mappings":";;;AAAA;AACA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,QAAQ,EAAEC,UAAU,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AACrF,OAAOC,SAAS,MAAM,YAAY;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEnC,MAAMC,YAAY,gBAAGR,aAAa,CAAC,CAAC;AAEpC,OAAO,MAAMS,eAAe,GAAGA,CAAA;EAAAC,EAAA;EAAA,OAAMR,UAAU,CAACM,YAAY,CAAC;AAAA;AAACE,EAAA,CAAjDD,eAAe;AAE5B,OAAO,MAAME,aAAa,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,GAAA;EAC7C,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;EACtD,MAAM,CAACe,SAAS,EAAEC,YAAY,CAAC,GAAGhB,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACiB,MAAM,EAAEC,SAAS,CAAC,GAAGlB,QAAQ,CAAC,CAAC,CAAC;EACvC,MAAM,CAACmB,UAAU,EAAEC,aAAa,CAAC,GAAGpB,QAAQ,CAAC,EAAE,CAAC;EAChD,MAAM,CAACqB,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGtB,QAAQ,CAAC,CAAC,CAAC,CAAC;EAC9D,MAAMuB,QAAQ,GAAGpB,MAAM,CAAC,IAAI,CAAC;EAE7B,MAAMqB,gBAAgB,GAAG,MAAOC,IAAI,IAAK;IACvCL,aAAa,CAACK,IAAI,CAAC;IACnB,IAAIJ,iBAAiB,KAAK,CAAC,CAAC,EAAE;MAC5B,MAAMK,QAAQ,GAAG,MAAMC,KAAK,CAAE,+BAA8BC,SAAS,CAACC,EAAG,EAAC,CAAC;MAC3E,IAAI,CAACH,QAAQ,CAACI,EAAE,EAAE;QAChB,MAAM,IAAIC,KAAK,CAAE,uBAAsBL,QAAQ,CAACM,MAAO,EAAC,CAAC;MAC3D;MACA,MAAMC,IAAI,GAAG,MAAMP,QAAQ,CAACO,IAAI,CAAC,CAAC;MAClC,MAAMC,SAAS,GAAGC,GAAG,CAACC,eAAe,CAAC,IAAIC,IAAI,CAAC,CAACJ,IAAI,CAAC,CAAC,CAAC;MAEvD,MAAMK,gBAAgB,GAAGb,IAAI,CAACJ,iBAAiB,CAAC;MAChD,MAAM;QAAEQ,EAAE;QAAEU,KAAK;QAAEC,MAAM;QAAEC;MAAM,CAAC,GAAGH,gBAAgB;MACrD,MAAMI,QAAQ,GAAGD,KAAK,GAAI,0BAAyBA,KAAK,CAAChB,IAAK,EAAC,GAAG,EAAE;MACpE,MAAMkB,QAAQ,GAAGT,SAAS;MAE1BpB,eAAe,CAAC;QACde,EAAE;QACFc,QAAQ;QACRC,SAAS,EAAEL,KAAK;QAChBC,MAAM;QACNE;MACF,CAAC,CAAC;IACJ;EACF,CAAC;EAGDxC,SAAS,CAAC,MAAM;IACd,IAAImB,iBAAiB,KAAK,CAAC,CAAC,EAAE;MAC5BP,eAAe,CAAC;QACde,EAAE,EAAEV,UAAU,CAACE,iBAAiB,CAAC,CAACQ,EAAE;QACpCc,QAAQ,EAAEE,SAAS,CAACxB,iBAAiB,CAAC,CAACa,SAAS;QAAE;QAClDU,SAAS,EAAEzB,UAAU,CAACE,iBAAiB,CAAC,CAACkB,KAAK;QAC9CC,MAAM,EAAErB,UAAU,CAACE,iBAAiB,CAAC,CAACmB,MAAM;QAC5CE,QAAQ,EAAEvB,UAAU,CAACE,iBAAiB,CAAC,CAACoB,KAAK,GAAI,0BAAyBtB,UAAU,CAACE,iBAAiB,CAAC,CAACoB,KAAK,CAAChB,IAAK,EAAC,GAAG;MACzH,CAAC,CAAC;IACJ;EACF,CAAC,EAAE,CAACN,UAAU,EAAEE,iBAAiB,CAAC,CAAC;EAEnC,MAAMyB,aAAa,GAAGA,CAAA,KAAM;IAC1B,IAAIzB,iBAAiB,KAAKF,UAAU,CAAC4B,MAAM,GAAG,CAAC,EAAE;IACjD,MAAMC,SAAS,GAAG3B,iBAAiB,GAAG,CAAC;IACvCC,oBAAoB,CAAC0B,SAAS,CAAC;EACjC,CAAC;EAED,MAAMC,iBAAiB,GAAGA,CAAA,KAAM;IAC9B,IAAI5B,iBAAiB,KAAK,CAAC,EAAE;IAC7B,MAAM6B,aAAa,GAAG7B,iBAAiB,GAAG,CAAC;IAC3CC,oBAAoB,CAAC4B,aAAa,CAAC;EACrC,CAAC;EAED,oBACE5C,OAAA,CAACC,YAAY,CAAC4C,QAAQ;IACpBC,KAAK,EAAE;MACLvC,YAAY;MACZC,eAAe;MACfC,SAAS;MACTC,YAAY;MACZC,MAAM;MACNC,SAAS;MACTC,UAAU;MACVK,gBAAgB;MAChBH,iBAAiB;MACjBC,oBAAoB;MACpBC,QAAQ;MACRuB,aAAa;MACbG;IACF,CAAE;IAAAtC,QAAA,EAEDA;EAAQ;IAAA0C,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACY,CAAC;AAE5B,CAAC;AAAC5C,GAAA,CA/EWF,aAAa;AAAA+C,EAAA,GAAb/C,aAAa;AAiF1BA,aAAa,CAACgD,SAAS,GAAG;EACxB/C,QAAQ,EAAEP,SAAS,CAACuD,IAAI,CAACC;AAC3B,CAAC;AAAC,IAAAH,EAAA;AAAAI,YAAA,CAAAJ,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}